---
import "../styles/global.css";

type Props = {
  title: string;
  description: string;
};

const { title, description } = Astro.props as Props;
---
<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <meta name="theme-color" content="#7C5CFF" />
    <title>{title}</title>

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og-placeholder.svg" />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <script is:inline>
      // theme (runs early)
      const t = localStorage.getItem("theme");
      if (t === "dark") document.documentElement.classList.add("dark");
      if (!t && window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
        document.documentElement.classList.add("dark");
      }
    </script>
  </head>
  <body class="min-h-screen bg-bg text-fg">
    <!-- background glow -->
    <div aria-hidden="true" class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
      <div class="absolute -top-40 left-1/2 h-[520px] w-[520px] -translate-x-1/2 rounded-full bg-accent/25 blur-3xl"></div>
      <div class="absolute top-40 right-[-140px] h-[420px] w-[420px] rounded-full bg-accent-2/20 blur-3xl"></div>
      <div class="absolute bottom-[-220px] left-[-180px] h-[520px] w-[520px] rounded-full bg-accent/15 blur-3xl"></div>
    </div>

    <slot />

    <button
      id="toTop"
      class="fixed bottom-5 right-5 hidden rounded-full border border-border/70 bg-card/80 px-3 py-3 text-sm shadow-soft backdrop-blur-md transition hover:-translate-y-0.5 hover:shadow-glow focus:outline-none focus:ring-2 focus:ring-accent/40"
      aria-label="Scroll to top"
      title="Scroll to top"
      >
      â†‘
    </button>

    <script is:inline>
      // reveal on scroll
      const revealEls = Array.from(document.querySelectorAll(".reveal"));
      const io = new IntersectionObserver((entries) => {
        for (const e of entries) {
          if (e.isIntersecting) {
            e.target.classList.add("is-visible");
            io.unobserve(e.target);
          }
        }
      }, { threshold: 0.12 });
      revealEls.forEach(el => io.observe(el));

      // scroll-to-top
      const toTop = document.getElementById("toTop");
      const onScroll = () => {
        if (!toTop) return;
        if (window.scrollY > 700) toTop.classList.remove("hidden");
        else toTop.classList.add("hidden");
      };
      window.addEventListener("scroll", onScroll, { passive: true });
      onScroll();
      toTop?.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
    </script>
  </body>
</html>
